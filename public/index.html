<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>React Tutorial</title>
		<!-- Not present in the tutorial. Just for basic styling. -->
		<link rel="stylesheet" href="css/base.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react-dom.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.15/browser.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>
	</head>
	<body>
		<div id="content"></div>
		<script type="text/babel"></script>
		<script type="text/babel">
			var data = [
                { author: "Pete Hunt", text: "This is one comment" },
                { author: "Jordan Walke", text: "This is *another* comment" }
            ];

			var CommentBox = React.createClass({displayName: 'CommentBox', 
                render: function() {
                    return (
                        React.createElement('div', {className: 'commentBox'}, 
                            React.createElement('h1', null, 
                                'Comments'),
                            React.createElement(CommentList, {data: this.props.data}),
                            React.createElement(CommentForm, null)
                        )
                    );
                }
            });

            var CommentList = React.createClass({ displayName: 'CommentList',
                render: function() {
                    var commentNodes = this.props.data.map(function(comment) {
                        return (
                            React.createElement(Comment, {author: comment.author}, comment.text)
                        )
                    });
                    return (
                        React.createElement('div', { className: 'commentList'}, 
                            commentNodes
                        )
                    )
                }
            });

            var CommentForm = React.createClass({ displayName: 'CommentForm', 
                render: function() {
                    return (
                        React.createElement('div', {className: 'commentForm'}, "Hello, world! I am a CommentForm.")
                    )
                }
            });

            var Comment = React.createClass({ displayName: 'Comment',
                rawMarkup: function() {
                    var rawMarkup = marked(this.props.children.toString(), {sanitize: true});
                    return { __html: rawMarkup }; 
                },
                render: function() {
                    return ( 
                        React.createElement('div', {className: 'comment'}, 
                            React.createElement('h2', {className: 'commentAuthor'}, this.props.author ),
                            React.createElement('span', {dangerouslySetInnerHTML: this.rawMarkup()})
                        )
                    )
                }
            });

            ReactDOM.render(
                React.createElement(CommentBox, {data: data}), 
                document.getElementById('content')
            );
		</script>
	</body>
</html>
